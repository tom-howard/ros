
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Here you'll learn how to work with images from an on-board camera. You will look at techniques to detect features within these images, and use this to inform robot decision-making.">
      
      
      
        <link rel="canonical" href="https://tom-howard.github.io/ros/com2009/assignment1/part6/">
      
      
        <link rel="prev" href="../part5/">
      
      
        <link rel="next" href="../../la2/">
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.4">
    
    
      
        <title>Part 6: Cameras, Machine Vision & OpenCV - Robotics in the Diamond: ROS</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../../assets/external/fonts.googleapis.com/css.c3479dc1.css">
        <style>:root{--md-text-font:"Source Sans Pro";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-1SSCKMNFPR"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-1SSCKMNFPR",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-1SSCKMNFPR",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Robotics in the Diamond: ROS" class="md-header__button md-logo" aria-label="Robotics in the Diamond: ROS" data-md-component="logo">
      
  <img src="../../../assets/tuos.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Robotics in the Diamond: ROS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part 6: Cameras, Machine Vision & OpenCV
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/tom-howard/ros" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    tom-howard/ros
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../about/" class="md-tabs__link">
          
  
    
  
  About

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../wsl-ros/" class="md-tabs__link">
          
  
    
  
  WSL-ROS

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  COM2009

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../waffles/" class="md-tabs__link">
          
  
    
  
  The Waffles

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../extras/launch-files/" class="md-tabs__link">
          
  
    
  
  ROS Extras

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../others/amr31001/" class="md-tabs__link">
          
  
    
  
  Other Courses

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Robotics in the Diamond: ROS" class="md-nav__button md-logo" aria-label="Robotics in the Diamond: ROS" data-md-component="logo">
      
  <img src="../../../assets/tuos.png" alt="logo">

    </a>
    Robotics in the Diamond: ROS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tom-howard/ros" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    tom-howard/ros
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../about/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    About
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/robots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Robots
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/acknowledgements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowledgements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Version History
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../wsl-ros/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    WSL-ROS
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            WSL-ROS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../wsl-ros/first-run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Launching for the First Time
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../wsl-ros/configure-vscode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring Visual Studio Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../wsl-ros/linux-term/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A Quick Introduction to the Linux Terminal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../wsl-ros/wsl-ros-return/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Re-Launching WSL-ROS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../wsl-ros/backup-restore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backing-Up (and Restoring) your Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../wsl-ros/rdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remote Access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../wsl-ros/wt-settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows Terminal Settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../wsl-ros/vscode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Launching VS Code (in WSL-ROS)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../wsl-ros/installing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing ROS on Your Own PC
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    COM2009
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            COM2009
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Assignment #1: An Introduction to ROS
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Assignment #1: An Introduction to ROS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 1: ROS & Linux Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 2: Odometry & Navigation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 3: SLAM & Autonomous Navigation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 4: ROS Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 5: ROS Actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Part 6: Cameras, Machine Vision & OpenCV
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Part 6: Cameras, Machine Vision & OpenCV
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aims" class="md-nav__link">
    <span class="md-ellipsis">
      Aims
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intended-learning-outcomes" class="md-nav__link">
    <span class="md-ellipsis">
      Intended Learning Outcomes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quick-links" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Resources
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-cameras-and-images-in-ros" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Cameras and Images in ROS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Working with Cameras and Images in ROS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#camera-topics-and-data" class="md-nav__link">
    <span class="md-ellipsis">
      Camera Topics and Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viz" class="md-nav__link">
    <span class="md-ellipsis">
      Visualising Camera Streams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualising Camera Streams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ex1" class="md-nav__link">
    <span class="md-ellipsis">
       Exercise 1: Using the RQT Image View node whilst changing the robot's viewpoint
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#opencv" class="md-nav__link">
    <span class="md-ellipsis">
      OpenCV and ROS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OpenCV and ROS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#object-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Object Detection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Object Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ex2" class="md-nav__link">
    <span class="md-ellipsis">
       Exercise 2: Object Detection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image-moments" class="md-nav__link">
    <span class="md-ellipsis">
      Image Moments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Image Moments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ex3" class="md-nav__link">
    <span class="md-ellipsis">
       Exercise 3: Locating image features using Image Moments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pid" class="md-nav__link">
    <span class="md-ellipsis">
      PID Control and Line Following
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PID Control and Line Following">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ex4" class="md-nav__link">
    <span class="md-ellipsis">
       Exercise 4: Line Following
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exercise 4: Line Following">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ex4a" class="md-nav__link">
    <span class="md-ellipsis">
      Part A: Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ex4b" class="md-nav__link">
    <span class="md-ellipsis">
      Part B: Implementing and Tuning a Proportional Controller
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ex4c" class="md-nav__link">
    <span class="md-ellipsis">
      Part C: Advanced Line Following
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wrapping-up" class="md-nav__link">
    <span class="md-ellipsis">
      Wrapping Up
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Wrapping Up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backup" class="md-nav__link">
    <span class="md-ellipsis">
      Saving your work
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../la2/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Lab Assignment #2 (2022-23)
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Lab Assignment #2 (2022-23)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../la2/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../la2/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started (Week 7 Tasks)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../la2/task1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 1: Creating a Deployable ROS Package
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../la2/task2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 2: Obstacle Avoidance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../la2/task3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 3: Maze Navigation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../la2/task4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 4: Detection, Search & Beaconing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../la2/task5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task 5: Real-World Exploration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../la2/extras/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Additional Resources
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_9" id="__nav_3_3_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_9">
            <span class="md-nav__icon md-icon"></span>
            Additional Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../la2/extras/laptops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with your ROS Packages on the laptops (with GitHub and SSH)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../la2/extras/submission/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exporting your ROS package for submission
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../assignment2/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Assignment #2: Team Robotics Project
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Assignment #2: Team Robotics Project
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignment2/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started in Week 1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../waffles/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    The Waffles
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            The Waffles
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../waffles/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../waffles/launching-ros/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Launching ROS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../waffles/exercises/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ROS & Waffle Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../waffles/shutdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shutdown Procedures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../waffles/tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tips & Tricks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../waffles/fact-finding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fact-Finding Missions!
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ROS Extras
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            ROS Extras
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../extras/launch-files/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Launch Files
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Launch Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extras/launch-files/launching-launch-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Launching Other Launch Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extras/launch-files/roslaunch-clas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ROSlaunch Command-line Arguments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extras/launch-files/python-clis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building Command-line Interfaces (CLIs) for Python Nodes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extras/launch-files/cla-to-node/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passing Command-line Arguments to Python Nodes via ROSlaunch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extras/launch-files/roslaunch-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using the ROSlaunch Python API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extras/ros-msgs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating Your Own Custom ROS Messages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/tom-howard/COM2009" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Course Repo (GitHub)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Other Courses
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Other Courses
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../others/amr31001/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    AMR31001
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            AMR31001
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/amr31001/lab1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 1: Mobile Robotics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/amr31001/lab2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 2: Feedback Control
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://lincaolab.github.io/acs6121/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ACS6121
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aims" class="md-nav__link">
    <span class="md-ellipsis">
      Aims
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intended-learning-outcomes" class="md-nav__link">
    <span class="md-ellipsis">
      Intended Learning Outcomes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quick-links" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Resources
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-cameras-and-images-in-ros" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Cameras and Images in ROS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Working with Cameras and Images in ROS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#camera-topics-and-data" class="md-nav__link">
    <span class="md-ellipsis">
      Camera Topics and Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viz" class="md-nav__link">
    <span class="md-ellipsis">
      Visualising Camera Streams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualising Camera Streams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ex1" class="md-nav__link">
    <span class="md-ellipsis">
       Exercise 1: Using the RQT Image View node whilst changing the robot's viewpoint
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#opencv" class="md-nav__link">
    <span class="md-ellipsis">
      OpenCV and ROS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OpenCV and ROS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#object-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Object Detection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Object Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ex2" class="md-nav__link">
    <span class="md-ellipsis">
       Exercise 2: Object Detection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image-moments" class="md-nav__link">
    <span class="md-ellipsis">
      Image Moments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Image Moments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ex3" class="md-nav__link">
    <span class="md-ellipsis">
       Exercise 3: Locating image features using Image Moments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pid" class="md-nav__link">
    <span class="md-ellipsis">
      PID Control and Line Following
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PID Control and Line Following">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ex4" class="md-nav__link">
    <span class="md-ellipsis">
       Exercise 4: Line Following
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exercise 4: Line Following">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ex4a" class="md-nav__link">
    <span class="md-ellipsis">
      Part A: Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ex4b" class="md-nav__link">
    <span class="md-ellipsis">
      Part B: Implementing and Tuning a Proportional Controller
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ex4c" class="md-nav__link">
    <span class="md-ellipsis">
      Part C: Advanced Line Following
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wrapping-up" class="md-nav__link">
    <span class="md-ellipsis">
      Wrapping Up
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Wrapping Up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backup" class="md-nav__link">
    <span class="md-ellipsis">
      Saving your work
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/tom-howard/ros/edit/main/docs/com2009/assignment1/part6.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/tom-howard/ros/raw/main/docs/com2009/assignment1/part6.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>Part 6: Cameras, Machine Vision & OpenCV</h1>

<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c-.34.34-.67.67-.68 1-.03.32.31.65.63.96.48.5.95.95.93 1.44-.02.49-.53 1-1.04 1.5l-4.13 4.14L15 14.66l4.25-4.24-.96-.96-1.42 1.41-3.75-3.75 3.84-3.83c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25l9.56-9.57 3.75 3.75L6.75 21H3v-3.75Z"/></svg></span> <strong>Exercises</strong>: 4<br />
<span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19.03 7.39 1.42-1.42c-.45-.51-.9-.97-1.41-1.41L17.62 6c-1.55-1.26-3.5-2-5.62-2a9 9 0 0 0 0 18c5 0 9-4.03 9-9 0-2.12-.74-4.07-1.97-5.61M13 14h-2V7h2v7m2-13H9v2h6V1Z"/></svg></span> <strong>Estimated Completion Time</strong>: 2 hours</p>
<h3 id="aims">Aims<a class="headerlink" href="#aims" title="Permanent link">&para;</a></h3>
<p>In this final part of the course you will <em>finally</em> make use of the TurtleBot3's camera, and look at how to work with images in ROS! Here we'll look at how to build ROS nodes that capture images and process them. We'll explore some ways in which this data can be used to inform decision-making in robotic applications.  </p>
<h3 id="intended-learning-outcomes">Intended Learning Outcomes<a class="headerlink" href="#intended-learning-outcomes" title="Permanent link">&para;</a></h3>
<p>By the end of this session you will be able to:</p>
<ol>
<li>Use a range of ROS tools to interrogate camera image topics on a ROS Network and view the images being streamed to them.</li>
<li>Use the computer vision library <em>OpenCV</em> with ROS, to obtain camera images and process them in real-time.  </li>
<li>Apply filtering processes to isolate objects of interest within an image.</li>
<li>Develop object detection nodes and harness the information generated by these processes to control a robot's position.</li>
<li>Use camera data as a feedback signal to implement a line following behaviour using proportional control.</li>
</ol>
<h3 id="quick-links">Quick Links<a class="headerlink" href="#quick-links" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="#ex1">Exercise 1: Using the <code>rqt_image_view</code> node whilst changing the robot's viewpoint</a></li>
<li><a href="#ex2">Exercise 2: Object Detection</a></li>
<li><a href="#ex3">Exercise 3: Locating image features using <em>Image Moments</em></a></li>
<li><a href="#ex4">Exercise 4: Line following</a></li>
</ul>
<h3 id="additional-resources">Additional Resources<a class="headerlink" href="#additional-resources" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="object_detection">The Initial Object Detection Code (for Exercise 2)</a></li>
<li><a href="object_detection_complete">A Complete Worked Example of the <code>object_detection.py</code> Node</a></li>
<li><a href="line_follower">A <code>line_follower</code> Template (for Exercise 4)</a></li>
</ul>
<h2 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<p><strong>Step 1: Launch WSL-ROS</strong><br />
Launch your WSL-ROS environment by running the WSL-ROS shortcut in the Windows Start Menu (if you haven't already done so). Once installed, the <em>Windows Terminal</em> app should launch with an <em>Ubuntu terminal instance</em> ready to go (<strong>TERMINAL 1</strong>).</p>
<p><strong>Step 2: Restore your work</strong><br />
When prompted (in <strong>TERMINAL 1</strong>), enter <code>Y</code> to restore your work from last time<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<p><strong>Step 3: Launch VS Code</strong><br />
Follow <a href="../../../wsl-ros/vscode">these steps</a> to launch VS Code correctly within the WSL-ROS environment.</p>
<p><strong>Step 4: Launch the Robot Simulation</strong><br />
In this session we'll start by working with the same <em>mystery world</em> environment from Part 5. In <strong>TERMINAL 1</strong>, use the following <code>roslaunch</code> command to load it:</p>
<hr />
<p><strong>TERMINAL 1:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>roslaunch<span class="w"> </span>tuos_simulations<span class="w"> </span>coloured_pillars.launch
</code></pre></div>
...and then wait for the Gazebo window to open:</p>
<figure>
<p><img alt="" src="../../../images/gazebo/coloured_pillars.png" width="800px" /></p>
</figure>
<h2 id="working-with-cameras-and-images-in-ros">Working with Cameras and Images in ROS<a class="headerlink" href="#working-with-cameras-and-images-in-ros" title="Permanent link">&para;</a></h2>
<h3 id="camera-topics-and-data">Camera Topics and Data<a class="headerlink" href="#camera-topics-and-data" title="Permanent link">&para;</a></h3>
<p>There are a number of tools that we can use to view the live images that are being captured by a robot's camera in ROS. As with all robot data, these streams are published to <em>topics</em>, so we firstly need to identify those topics.</p>
<p>In a new terminal instance (<strong>TERMINAL 2</strong>), run <code>rostopic list</code> to see the full list of topics that are currently active on our system. Conveniently, all the topics related to our robot's <em>camera</em> are prefixed with <code>camera</code>! Filter the <code>rostopic list</code> output using <code>grep</code> (a Linux command), to filter the list and only show topics prefixed with <code>/camera</code>:</p>
<hr />
<p><strong>TERMINAL 2:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>rostopic<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>/camera
</code></pre></div></p>
<p>This should provide the following filtered list:</p>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>/camera/depth/camera_info
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>/camera/depth/image_raw
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>/camera/depth/points
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>/camera/parameter_descriptions
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>/camera/parameter_updates
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>/camera/rgb/camera_info
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>/camera/rgb/image_raw
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>/camera/rgb/image_raw/compressed
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>/camera/rgb/image_raw/compressed/parameter_descriptions
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>/camera/rgb/image_raw/compressed/parameter_updates
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>/camera/rgb/image_raw/compressedDepth
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>/camera/rgb/image_raw/compressedDepth/parameter_descriptions
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>/camera/rgb/image_raw/compressedDepth/parameter_updates
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>/camera/rgb/image_raw/theora
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>/camera/rgb/image_raw/theora/parameter_descriptions
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>/camera/rgb/image_raw/theora/parameter_updates
</code></pre></div>
<hr />
<p>Our <em>real</em> TurtleBot3 Waffles in the Diamond have a slightly different camera module to that used by the <em>simulated</em> robots that we are working with here.  Despite this though, the camera data on our real robots is published to topics using the same ROS message formats as used in simulation, making it fairly straight-forward to transfer nodes that we develop in simulation here onto the real robots<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>.</p>
<p>The first items in the list of camera topics above tell us that <em>depth</em> information is available here. Much like the real robots, the simulated versions that we are working with here also have a camera module capable of determining depth information as well as simply capturing images.  <a href="../part3/#lidar">Remember from Part 3 though</a>, that we also have a very capable LiDAR sensor to give us this type of information too, and so we won't really be using the depth capabilities of our camera in this session.</p>
<p>The main thing we are actually interested in here is the <em>RGB images</em> that are captured by the camera, and the key topic that we'll therefore be using here is:</p>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>/camera/rgb/image_raw
</code></pre></div>
<p>Run <code>rostopic info</code> on this to identify the message <em>type</em>.</p>
<p>Now, run <code>rosmsg info</code> on this message type to find out exactly what information is published to the topic.  You should end up with a list that looks like this:</p>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>std_msgs/Header header
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>  uint32 seq
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>  time stamp
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>  string frame_id
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>uint32 height
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>uint32 width
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>string encoding
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>uint8 is_bigendian
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>uint32 step
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>uint8[] data
</code></pre></div>
<p><a name="cam_img_questions"></a></p>
<div class="admonition question">
<p class="admonition-title">Questions</p>
<ol>
<li>What <em>type</em> of message is used on this topic, and which <em>package</em> is this message derived from?</li>
<li>Using <code>rostopic echo</code> and the information about the topic message (as shown above) determine the <em>size</em> of the images that our robot's camera will capture (i.e. its <em>dimensions</em>, in pixels).  It will be quite important to know this when we start manipulating these camera images later on. </li>
<li>Finally, considering the list above again, which part of the message do you think contains the <em>actual image data</em>?</li>
</ol>
</div>
<h3 id="viz">Visualising Camera Streams<a class="headerlink" href="#viz" title="Permanent link">&para;</a></h3>
<p>We can <em>view</em> the images being streamed to the above camera topic (in real-time) in a variety of different ways, and we'll explore a couple of these now.</p>
<p>One way is to use <em>RViz</em>, which can be launched using the following <code>roslaunch</code> command:</p>
<hr />
<p><strong>TERMINAL 2:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>roslaunch<span class="w"> </span>turtlebot3_gazebo<span class="w"> </span>turtlebot3_gazebo_rviz.launch
</code></pre></div></p>
<hr />
<p>Once RViz launches, find the camera item in the left-hand panel and tick the checkbox next to it. This should open up a camera panel with a live stream of the images being obtained from the robot's camera!  The nice thing about this is that the real-time LiDAR data will also be overlaid on top of the images too!</p>
<figure>
<p><img alt="" src="../../../images/rviz/camera_stream.png" width="800px" /></p>
</figure>
<p>Close down RViz by entering <span class="keys"><kbd class="key-control">Ctrl</kbd><span>+</span><kbd class="key-c">C</kbd></span> in <strong>TERMINAL 2</strong>.  </p>
<h4 id="ex1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c-.34.34-.67.67-.68 1-.03.32.31.65.63.96.48.5.95.95.93 1.44-.02.49-.53 1-1.04 1.5l-4.13 4.14L15 14.66l4.25-4.24-.96-.96-1.42 1.41-3.75-3.75 3.84-3.83c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25l9.56-9.57 3.75 3.75L6.75 21H3v-3.75Z"/></svg></span> Exercise 1: Using the RQT Image View node whilst changing the robot's viewpoint<a class="headerlink" href="#ex1" title="Permanent link">&para;</a></h4>
<p>Another tool we can use to view camera data-streams is the <code>rqt_image_view</code> node.</p>
<ol>
<li>
<p>To launch this, use <code>rosrun</code> as follows:</p>
<hr />
<p><strong>TERMINAL 2:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>rosrun<span class="w"> </span>rqt_image_view<span class="w"> </span>rqt_image_view
</code></pre></div>
<figure markdown>
  <img alt="" src="../../../images/rqt/img_view.png" />
</figure></p>
<p>This is a nice tool that allows us to easily view images that are being published to any camera topic on the ROS network. Another useful feature is the ability to save these images (as <code>.jpg</code> files) to the filesystem: See the "Save as image" button highlighted in the figure above. This might be useful later on...</p>
<hr />
</li>
<li>
<p>Click the drop-down box in the top left of the window to select an image topic to display.  Select <code>/camera/rgb/image_raw</code> (if it's not already selected).</p>
</li>
<li>
<p>Keep this window open now, and launch a new terminal instance (<strong>TERMINAL 3</strong>).</p>
</li>
<li>
<p>Launch the <code>turtlebot3_teleop</code> node, either using <a href="../part1/#teleop">the full command</a> or a handy alias: <code>tb3_teleop</code>! Rotate your robot on the spot, keeping an eye on the <code>rqt_image_view</code> window as you do this.  Stop the robot once one of the coloured pillars in the arena is roughly in the centre of the robot's field of vision, then close the <code>turtlebot3_teleop</code> node and the <code>rqt_image_view</code> node by entering <span class="keys"><kbd class="key-control">Ctrl</kbd><span>+</span><kbd class="key-c">C</kbd></span> in <strong>TERMINAL 3</strong> and <strong>TERMINAL 2</strong> respectively.</p>
</li>
</ol>
<h2 id="opencv">OpenCV and ROS<a class="headerlink" href="#opencv" title="Permanent link">&para;</a></h2>
<p><a href="https://opencv.org/">OpenCV</a> is a mature and powerful computer vision library designed for performing real-time image analysis, and it is therefore extremely useful for robotic applications.  The library is cross-platform and there is a Python API (<code>cv2</code>), which we'll be using to do some computer vision tasks of our own during this lab session. While we can work with OpenCV using Python straight away (via the API), the library can't directly interpret the native image format used by the ROS, so there is an <em>interface</em> that we need to use.  The interface is called <a href="http://wiki.ros.org/cv_bridge">CvBridge</a>, which is a <em>ROS package</em> that handles the conversion between ROS and OpenCV image formats.  We'll therefore need to use these two libraries (OpenCV and CvBridge) hand-in-hand when developing ROS nodes to perform computer vision related tasks.</p>
<h3 id="object-detection">Object Detection<a class="headerlink" href="#object-detection" title="Permanent link">&para;</a></h3>
<p>One common job that we often want a robot to perform is <em>object detection</em>, and we will illustrate how this can be achieved using OpenCV tools for <em>colour filtering</em>, to detect the coloured pillar that your robot should now be looking at.  </p>
<h4 id="ex2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c-.34.34-.67.67-.68 1-.03.32.31.65.63.96.48.5.95.95.93 1.44-.02.49-.53 1-1.04 1.5l-4.13 4.14L15 14.66l4.25-4.24-.96-.96-1.42 1.41-3.75-3.75 3.84-3.83c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25l9.56-9.57 3.75 3.75L6.75 21H3v-3.75Z"/></svg></span> Exercise 2: Object Detection<a class="headerlink" href="#ex2" title="Permanent link">&para;</a></h4>
<p>In this exercise you will learn how to use OpenCV to capture images, filter them and perform other analysis to confirm the presence and location of features that we might be interested in.</p>
<p><strong>Step 1</strong></p>
<ol>
<li>First create a new package in your <code>catkin_ws/src</code> directory called <code>part6_vision</code> with <code>rospy</code>, <code>cv_bridge</code>, <code>sensor_msgs</code> and <code>geometry_msgs</code> as dependencies.</li>
<li>Then, run <code>catkin build</code> on the package and then re-source your environment (as you've done so many times by now!)</li>
<li>In the <code>src</code> folder of the package you have just created, create a new Python file called <code>object_detection.py</code>. <em>What else do we need to do to this file before we can run it?</em> <strong>Do it now!</strong></li>
<li>Copy <a href="object_detection">the code here</a>, save the file, then read the annotations so that you understand how this node works and what should happen when you run it. <a name="ex2_ret"></a></li>
<li>
<p>Run the node using <code>rosrun</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This node will capture an image and display it in a pop-up window. Once you've viewed the image in this pop-up window <strong>MAKE SURE YOU CLOSE THE POP-UP WINDOW DOWN</strong> so that the node can complete its execution!</p>
</div>
</li>
<li>
<p>As you should know from reading the explainer, the node has just obtained an image and saved it to a location on the filesystem.  Navigate to this filesystem location and view the image using <code>eog</code>.</p>
</li>
</ol>
<p>What you may have noticed from the terminal output when you ran the <code>object_detection.py</code> node is that the robot's camera captures images at a native size of 1080x1920 pixels (you should already know this from interrogating the <code>/camera/rgb/image_raw/width</code> and <code>/height</code> messages using <code>rostopic echo</code> earlier, right?!).  That's over 2 million pixels in total in a single image (2,073,600 pixels per image, to be exact), each pixel having a blue, green and red value associated with it - so that's a lot of data in a single image file! </p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>The size of the image file (in bytes) was actually printed to the terminal when you ran the <code>object_detection.py</code> node. Did you notice how big it was exactly?</p>
</div>
<p>Processing an image of this size is therefore hard work for a robot: any analysis we do will be slow and any raw images that we capture will occupy a considerable amount of storage space. The next step then is to reduce this down by cropping the image to a more manageable size.</p>
<p><strong>Step 2</strong></p>
<p>We're going to modify the <code>object_detection.py</code> node now to:</p>
<ul>
<li>Capture a new image in its native size</li>
<li>Crop it down to focus in on a particular area of interest</li>
<li>
<p>Save both of the images (the cropped one should be much smaller than the original).</p>
</li>
<li>
<p>In your <code>object_detection.py</code> node locate the line:</p>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">show_and_save_image</span><span class="p">(</span><span class="n">cv_img</span><span class="p">,</span> <span class="n">img_name</span> <span class="o">=</span> <span class="s2">&quot;step1_original&quot;</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>Underneath this</strong>, add the following additional lines of code:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">crop_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">400</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">crop_height</span> <span class="o">=</span> <span class="mi">400</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">crop_y0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">crop_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">crop_z0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">crop_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">cv_img</span><span class="p">[</span><span class="n">crop_z0</span><span class="p">:</span><span class="n">crop_z0</span><span class="o">+</span><span class="n">crop_height</span><span class="p">,</span> <span class="n">crop_y0</span><span class="p">:</span><span class="n">crop_y0</span><span class="o">+</span><span class="n">crop_width</span><span class="p">]</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="n">show_and_save_image</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">,</span> <span class="n">img_name</span> <span class="o">=</span> <span class="s2">&quot;step2_cropping&quot;</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Run the node again.  </p>
<div class="admonition tip">
<p class="admonition-title">Remember</p>
<p>Make sure you close all of these pop-up windows down after viewing them to ensure that <strong>all</strong> your images are saved to the filesystem and the node completes all of its tasks successfully.</p>
</div>
<p>The code that you have just added here has created a new image object called <code>cropped_img</code>, from a subset of the original by specifying a desired <code>crop_height</code> and <code>crop_width</code> relative to the original image dimensions.  Additionally, we have also specified <em>where</em> in the original image (in terms of pixel coordinates) we want this subset to start, using <code>crop_y0</code> and <code>crop_z0</code>. This process is illustrated in the figure below:</p>
<p><figure markdown>
  <img alt="" src="od1_cropping.png" />
</figure></p>
<p><a name="img_cropping" ></a>The original image (<code>cv_img</code>) is cropped using a process called <em>"slicing"</em>:</p>
<p><div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">cv_img</span><span class="p">[</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="n">crop_z0</span><span class="p">:</span><span class="n">crop_z0</span><span class="o">+</span><span class="n">crop_height</span><span class="p">,</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="n">crop_y0</span><span class="p">:</span><span class="n">crop_y0</span><span class="o">+</span><span class="n">crop_width</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>    <span class="p">]</span>
</code></pre></div>
This may seem quite confusing, but hopefully the figure below illustrates what's going on here:</p>
<p><figure markdown>
  <img alt="" src="img_slicing.png" />
</figure></p>
</li>
</ul>
<p><strong>Step 3</strong></p>
<p>As discussed above, an image is essentially a series of pixels each with a blue, green and red value associated with it to represent the actual image colours.  From the original image that we have just obtained and cropped, we <em>then</em> want to get rid of any colours other than those associated with the pillar that we want the robot to detect.  We therefore need to apply a <em>filter</em> to the pixels, which we will ultimately use to discard any pixel data that isn't related to the coloured pillar, whilst retaining data that is.  </p>
<p>This process is called <em>masking</em> and, to achieve this, we need to set some colour thresholds. This can be difficult to do in a standard Blue-Green-Red (BGR) or Red-Green-Blue (RGB) colour space, and you can see a good example of this in <a href="https://realpython.com/python-opencv-color-spaces/">this article from RealPython.com</a>.  We will apply some steps discussed in this article to convert our cropped image into a <a href="https://en.wikipedia.org/wiki/HSL_and_HSV">Hue-Saturation-Value (HSV)</a> colour space instead, which makes the process of colour masking a bit easier.</p>
<ol>
<li>
<p>First, analyse the <em>Hue</em> and <em>Saturation</em> values of the cropped image. To do this, first navigate to the "myrosdata/object_detection" directory, where the raw image has been saved:</p>
<hr />
<p><strong>TERMINAL 2:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">cd</span><span class="w"> </span>~/myrosdata/object_detection
</code></pre></div></p>
<p>Then, run the following ROS Node (from the <code>tuos_examples</code> package), supplying the name of the cropped image as an additional argument:<a name="img_cols_node"></a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>rosrun<span class="w"> </span>tuos_examples<span class="w"> </span>image_colours.py<span class="w"> </span>step2_cropping.jpg
</code></pre></div>
<hr />
</li>
<li>
<p>The node should produce a scatter plot, illustrating the Hue and Saturation values of each of the pixels in the image. Each data point in the plot represents a single image pixel and each is coloured to match its RGB value:</p>
<p><figure markdown>
  <img alt="" src="od2_hs_scatter.png" />
</figure></p>
</li>
<li>
<p>You should see from the image that all the pixels related to the coloured pillar that we want to detect are clustered together.  We can use this information to specify a range of Hue and Saturation values that can be used to mask our image: filtering out any colours that sit outside this range and thus allowing us to isolate the pillar itself. The pixels also have a <em>Value</em> (or <em>"Brightness"</em>), which isn't shown in this plot. As a rule of thumb, a range of brightness values between 100 and 255 generally works quite well.</p>
<p><figure markdown>
  <img alt="" src="od3_hs_thresholds.png" />
</figure></p>
<p>In this case then, we select upper and lower HSV thresholds as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">lower_threshold</span> <span class="o">=</span> <span class="p">(</span><span class="mi">115</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">upper_threshold</span> <span class="o">=</span> <span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</code></pre></div>
<p>Use the plot that has been generated here to determine your own upper and lower thresholds. <a name="bw_and"></a></p>
<p>OpenCV contains a built-in function to detect which pixels of an image fall within a specified HSV range: <code>cv2.inRange()</code>.  This outputs a matrix, the same size and shape as the number of pixels in the image, but containing only <code>True</code> (<code>1</code>) or <code>False</code> (<code>0</code>) values, illustrating which pixels <em>do</em> have a value within the specified range and which don't.  This is known as a <em>Boolean Mask</em> (essentially, a series of ones or zeroes).  We can then apply this mask to the image, using a <a href="https://en.wikipedia.org/wiki/Bitwise_operation#AND">Bitwise AND</a> operation, to get rid of any image pixels whose mask value is <code>False</code> and keep any flagged as <code>True</code> (or <em>in range</em>).</p>
</li>
<li>
<p>To do this, first locate the following line in your <code>object_detection.py</code> node:</p>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">show_and_save_image</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">,</span> <span class="n">img_name</span> <span class="o">=</span> <span class="s2">&quot;step2_cropping&quot;</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Underneath this, add the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">hsv_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">lower_threshold</span> <span class="o">=</span> <span class="p">(</span><span class="mi">115</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">upper_threshold</span> <span class="o">=</span> <span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">img_mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="n">hsv_img</span><span class="p">,</span> <span class="n">lower_threshold</span><span class="p">,</span> <span class="n">upper_threshold</span><span class="p">)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="n">show_and_save_image</span><span class="p">(</span><span class="n">img_mask</span><span class="p">,</span> <span class="n">img_name</span> <span class="o">=</span> <span class="s2">&quot;step3_image_mask&quot;</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Now, run the node again. <em>Three</em> images should be generated and saved now.  As shown in the figure below, the third image should simply be a black and white representation of the cropped image, where the white regions should indicate the areas of the image where pixel values fall within the HSV range specified earlier.  Notice (from the text printed to the terminal) that the cropped image and the image mask have the same dimensions, but the image mask file has a significantly smaller file size.  While the mask contains the same <em>number</em> of pixels, these pixels only have a value of <code>1</code> or <code>0</code>, whereas - in the cropped image of the same pixel size - each pixel has a Red, Green and Blue value: each ranging between <code>0</code> and <code>255</code>, which represents significantly more data.</p>
<p><figure markdown>
  <img alt="" src="od4_masking.png" />
</figure></p>
</li>
</ol>
<p><strong>Step 4</strong> <a name="bitwise_and"></a></p>
<p>Finally, we can apply this mask to the cropped image, generating a final version of it where only pixels marked as <code>True</code> in the mask retain their RGB values, and the rest are simply removed.  <a href="#bw_and">As discussed earlier</a>, we use a <em>Bitwise AND</em> operation to do this and, once again, OpenCV has a built-in function to do this: <code>cv2.bitwise_and()</code>.</p>
<ol>
<li>
<p>Locate the following line in your <code>object_detection.py</code> node:</p>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">show_and_save_image</span><span class="p">(</span><span class="n">img_mask</span><span class="p">,</span> <span class="n">img_name</span> <span class="o">=</span> <span class="s2">&quot;step3_image_mask&quot;</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>And, underneath this, add the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">filtered_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">,</span> <span class="n">cropped_img</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">img_mask</span><span class="p">)</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">show_and_save_image</span><span class="p">(</span><span class="n">filtered_img</span><span class="p">,</span> <span class="n">img_name</span> <span class="o">=</span> <span class="s2">&quot;step4_filtered_image&quot;</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Run this node again, and a fourth image should also be generated now, this time showing the cropped image taken from the robot's camera, but only containing data related to coloured pillar, with all other background image data removed (and rendered black):</p>
<p><figure markdown>
  <img alt="" src="od5_filtering.png" />
</figure></p>
</li>
</ol>
<h3 id="image-moments">Image Moments<a class="headerlink" href="#image-moments" title="Permanent link">&para;</a></h3>
<p>You have now successfully isolated an object of interest within your robot's field of vision, but perhaps we want to make our robot move towards it, or - conversely - make our robot navigate around it and avoid crashing into it!  We therefore also need to know the <em>position</em> of the object in relation to the robot's viewpoint, and we can do this using <strong>image moments</strong>.</p>
<p>The work we have just done above led to us obtaining what is referred to as a <em>colour blob</em>.  OpenCV also has built-in tools to allow us to calculate the <em>centroid</em> of a colour blob like this, allowing us to determine where exactly within an image the object of interest is located (in terms of pixels).  This is done using the principle of <em>image moments</em>: essentially statistical parameters related to an image, telling us how a collection of pixels (i.e. the blob of colour that we have just isolated) are distributed within it.  <a href="https://theailearner.com/tag/image-moments-opencv-python/">You can read more about Image Moments here</a>, which tells us that the central coordinates of a colour blob can be obtained by considering some key moments of the <em>image mask</em> that we obtained from thresholding earlier:</p>
<ul>
<li><code>M<sub>00</sub></code>: the sum of all non-zero pixels in the image mask (i.e. the size of the colour blob, in pixels)</li>
<li><code>M<sub>10</sub></code>: the sum of all the non-zero pixels in the horizontal (y) axis, weighted by <em>row</em> number</li>
<li><code>M<sub>01</sub></code>: the sum of all the non-zero pixels in the vertical (z) axis, weighted by <em>column</em> number</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Remember</p>
<p>We refer to the <em>horizontal</em> as the <em>y-axis</em> and the <em>vertical</em> as the <em>z-axis</em> here, to match the terminology that we have used previously to define <a href="../part2/#principal-axes">our robot's principal axes</a>.</p>
</div>
<p>We don't really need to worry about the derivation of these moments too much though.  OpenCV has a built-in <code>moments()</code> function that we can use to obtain this information from an image mask (such as the one that we generated earlier):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">m</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">img_mask</span><span class="p">)</span>
</code></pre></div>
<p>So, using this we can obtain the <code>y</code> and <code>z</code> coordinates of the blob centroid quite simply:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">cy</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;m10&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">]</span><span class="o">+</span><span class="mf">1e-5</span><span class="p">)</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">cz</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;m01&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">]</span><span class="o">+</span><span class="mf">1e-5</span><span class="p">)</span> 
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>We're adding a very small number to the <code>M<sub>00</sub></code> moment here to make sure that the divisor in the above equations is never zero and thus ensuring that we never get caught out by any "divide-by-zero" errors. Why might this be necessary?</p>
</div>
<figure>
<p><img alt="" src="od6_centroid.png" /></p>
</figure>
<p>Once again, there is a built-in OpenCV tool that we can use to add a circle onto an image to illustrate the centroid location within the robot's viewpoint: <code>cv2.circle()</code>.  This is how we produced the red circle that you can see in the figure above.  You can see how this is implemented in <a href="object_detection_complete">a complete worked example of the <code>object_detection.py</code> node</a> from the previous exercise. <a name="ex2b_ret"></a></p>
<p>In our case, we can't actually change the position of our robot in the z axis, so the <code>cz</code> centroid component here might not be that important to us for navigation purposes.  We may however want to use the centroid coordinate <code>cy</code> to understand where a feature is located <em>horizontally</em> in our robot's field of vision, and use this information to turn towards it (or away from it, depending on what we are trying to achieve).  We can then use this as the basis for some real <strong>closed-loop</strong> control.</p>
<h4 id="ex3"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c-.34.34-.67.67-.68 1-.03.32.31.65.63.96.48.5.95.95.93 1.44-.02.49-.53 1-1.04 1.5l-4.13 4.14L15 14.66l4.25-4.24-.96-.96-1.42 1.41-3.75-3.75 3.84-3.83c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25l9.56-9.57 3.75 3.75L6.75 21H3v-3.75Z"/></svg></span> Exercise 3: Locating image features using <em>Image Moments</em><a class="headerlink" href="#ex3" title="Permanent link">&para;</a></h4>
<p>Inside the <code>tuos_examples</code> package there is a node that has been developed to illustrate how all the OpenCV tools that you have explored so far could be used to search an environment and stop a robot when it is looking directly at an object of interest. All the tools that are used in this node should be familiar to you by now, and in this exercise you're going to make a copy of this node and modify it to enhance its functionality.</p>
<ol>
<li>
<p>The node is called <code>colour_search.py</code>, and it is located in the <code>src</code> folder of the <code>tuos_examples</code> package. Copy this into the <code>src</code> folder of your own <code>part6_vision</code> package by first ensuring that you are located in the desired destination folder:</p>
<hr />
<p><strong>TERMINAL 2:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>roscd<span class="w"> </span>part6_vision/src
</code></pre></div></p>
<hr />
</li>
<li>
<p>Then, copy the <code>colour_search.py</code> node using <code>cp</code> as follows:</p>
<hr />
<p><strong>TERMINAL 2:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>cp<span class="w"> </span>~/catkin_ws/src/tuos_ros/tuos_examples/src/colour_search.py<span class="w"> </span>./
</code></pre></div></p>
<hr />
</li>
<li>
<p>You'll need to copy the <code>tb3.py</code> module across from the <code>tuos_examples</code> package, as this is used by the <code>colour_search.py</code> node to make the robot move:</p>
<hr />
<p><strong>TERMINAL 2:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>cp<span class="w"> </span>~/catkin_ws/src/tuos_ros/tuos_examples/src/tb3.py<span class="w"> </span>./
</code></pre></div></p>
<hr />
</li>
<li>
<p>Open up the <code>colour_search.py</code> file in VS Code to view the content.  Have a look through it and see if you can make sense of how it works.  The overall structure should be fairly familiar to you by now: we have a Python class structure, a Subscriber with a callback function, a main loop where all the robot control takes place and a lot of the OpenCV tools that you have explored so far in this session.  Essentially this node functions as follows:</p>
<ol>
<li>The robot turns on the spot whilst obtaining images from its camera (by subscribing to the <code>/camera/rgb/image_raw</code> topic).</li>
<li>Camera images are obtained, cropped, then a threshold is applied to the cropped images to detect the blue pillar in the simulated environment.</li>
<li>If the robot can't see a blue pillar then it turns on the spot <strong>quickly</strong>.</li>
<li>Once detected, the centroid of the blue blob representing the pillar is calculated to obtain its current <em>location</em> in the robot's viewpoint.</li>
<li>As soon as the blue pillar comes into view the robot starts to turn more <strong>slowly</strong> instead.</li>
<li>The robot <strong>stops</strong> turning as soon as it determines that the pillar is situated directly in front of it (determined using the <code>cy</code> component of the blue blob centroid).</li>
<li>The robot then <strong>waits</strong> for a while and then starts to turn again.</li>
<li>The whole process repeats until it finds the blue pillar once again.</li>
</ol>
</li>
<li>Run the node as it is to see this in action.  Observe the messages that are printed to the terminal throughout execution.</li>
<li><strong>Your task</strong> is to then modify the node so that it stops in front of <em>every coloured pillar</em> in the arena (there are four in total). For this, you may need to use some of the methods that you have explored in the previous exercises.<ol>
<li>You might first want to use some of the methods that we used to obtain and analyse some images from the robot's camera:<ol>
<li>Use the <code>turtlebot3_teleop</code> node to manually move the robot, making it look at every coloured pillar in the arena individually.</li>
<li>Run the <code>object_detection.py</code> node that you developed in the previous exercise to capture an image, crop it, save it to the filesystem and then feed this cropped image into the <code>image_colours.py</code> node from the <code>tuos_examples</code> package (<a href="#img_cols_node">as you did earlier</a>)</li>
<li>From the plot that is generated by the <code>image_colours.py</code> node, determine some appropriate HSV thresholds to apply for each coloured pillar in the arena.</li>
</ol>
</li>
<li>Once you have the right thresholds, then you can add these to your <code>colour_search.py</code> node so that it has the ability to detect <em>every</em> pillar in the same way that it currently detects the blue one.</li>
</ol>
</li>
</ol>
<h3 id="pid">PID Control and Line Following<a class="headerlink" href="#pid" title="Permanent link">&para;</a></h3>
<p>Line following is a handy skill for a robot to have! We can achieve this on our TurtleBot3 using its camera system and the image processing techniques that have been covered so far in this session.</p>
<p>COM2009 Lecture 6 introduces a well established algorithm for closed-loop control known as <strong>PID Control</strong>, and this can be used to achieve such line following behaviour.</p>
<p>At the heart of this is the principle of <em>Negative-Feedback</em> control, which considers a <strong>Reference Input</strong>, a <strong>Feedback Signal</strong> and the <strong>Error</strong> between these.</p>
<p><a name="neg_fdbck_ctrl"></a></p>
<figure>
<p><img alt="" src="negative_feedback_control.png" width="500" />
  </p>
<figcaption>
    Negative-Feedback Control<br />
    Adapted from <a href="https://commons.wikimedia.org/wiki/File:PID_en.svg">Arturo Urquizo (via Wikimedia Commons)</a>
  </figcaption>
</figure>
<p>The <strong>Reference Input</strong> represents a desired state that we would like our system to maintain. If we want our TurtleBot3 to successfully follow a coloured line on the floor, we will need it to keep the colour blob that represents that coloured line in the centre of its view point at all times. The <em>desired state</em> would therefore be to maintain the <code>cy</code> centroid of the colour blob in the centre of its vision.</p>
<p>A <strong>Feedback Signal</strong> informs us of what the current state of the system actually is. In our case, this feedback signal would be the real-time location of the coloured line in the live camera images, i.e. its <code>cy</code> centroid (obtained using processing methods such as those covered in Exercise 3 above). </p>
<p>The difference between these two things is the <strong>Error</strong>, and the PID control algorithm provides us with a means to control this error and minimise it, so that our robot's <em>actual</em> state matches the <em>desired</em> state. i.e.: the coloured line is always in the centre of its viewpoint.</p>
<p><a name="pid_terms"></a></p>
<figure>
<p><img alt="" src="pid_terms.png" /></p>
</figure>
<p><a name="pid_eqn"></a></p>
<p>The PID algorithm is as follows:</p>
<div class="arithmatex">\[
u(t)=K_{P} e(t) + K_{I}\int e(t)dt + K_{D}\dfrac{de}{dt}
\]</div>
<p>Where <span class="arithmatex">\(u(t)\)</span> is the <strong>Controlled Output</strong>, <span class="arithmatex">\(e(t)\)</span> is the <strong>Error</strong> (as illustrated in the figure above) and <span class="arithmatex">\(K_{P}\)</span>, <span class="arithmatex">\(K_{I}\)</span> and <span class="arithmatex">\(K_{D}\)</span> are Proportional, Integral and Differential <strong>Gains</strong> respectively. These three gains are constants that must be established for any given system through a process called <em>tuning</em>. This tuning process is discussed in COM2009 Lecture 6, but you will also explore this in the practical exercise that follows.</p>
<h4 id="ex4"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c-.34.34-.67.67-.68 1-.03.32.31.65.63.96.48.5.95.95.93 1.44-.02.49-.53 1-1.04 1.5l-4.13 4.14L15 14.66l4.25-4.24-.96-.96-1.42 1.41-3.75-3.75 3.84-3.83c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25l9.56-9.57 3.75 3.75L6.75 21H3v-3.75Z"/></svg></span> Exercise 4: Line Following<a class="headerlink" href="#ex4" title="Permanent link">&para;</a></h4>
<h5 id="ex4a">Part A: Setup<a class="headerlink" href="#ex4a" title="Permanent link">&para;</a></h5>
<ol>
<li>Make sure that all ROS processes from the previous exercise are shut down now, including the <code>colour_search.py</code> node, and the Gazebo simulation in <strong>TERMINAL 1</strong>.</li>
<li>
<p>In <strong>TERMINAL 1</strong> launch a new simulation from the <code>tuos_simulations</code> package:</p>
<hr />
<p><strong>TERMINAL 1:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>roslaunch<span class="w"> </span>tuos_simulations<span class="w"> </span>line_following_setup.launch
</code></pre></div></p>
<hr />
<p>Your robot should be launched onto a long thin track with a straight pink line painted down the middle of the floor:</p>
<p><figure markdown>
  <img alt="" src="line_following_setup.png" width="800px" />
</figure></p>
</li>
<li>
<p>In <strong>TERMINAL 2</strong> you should still be located in your <code>part6_vision/src</code> directory, but if not then go there now:</p>
<hr />
<p><strong>TERMINAL 2:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>roscd<span class="w"> </span>part6_vision/src
</code></pre></div></p>
<hr />
</li>
<li>
<p>Perform the necessary steps to create a new empty Python file called <code>line_follower.py</code> and prepare it for execution.</p>
</li>
<li>
<p>Once that's done open up the empty file in VS Code.</p>
<p><a name="ex4a_ret"></a></p>
</li>
<li>
<p>Start with <a href="line_follower">the code template provided here</a>. This template contains three "TODOs" that you need to complete, all of which are explained in detail in the code annotations, so read these carefully. Ultimately, you did all of this in <a href="#ex2">Exercise 2</a>, so go back here if you need a reminder on how any of this works. </p>
<p>Your aim here is to get the code to generate a cropped image, with the coloured line isolated and located within it, like this:</p>
<p><figure markdown>
  <img alt="" src="line_follower_setup_complete.jpg" />
</figure> </p>
</li>
</ol>
<h5 id="ex4b">Part B: Implementing and Tuning a Proportional Controller<a class="headerlink" href="#ex4b" title="Permanent link">&para;</a></h5>
<p>Referring back to <a href="#pid_eqn">the equation for the PID algorithm as discussed above</a>, the Proportional, Integral and Differential components all have different effects on a system in terms of its ability to maintain the desired state (the reference input). The gain terms associated with each of these components (<span class="arithmatex">\(K_{P}\)</span>, <span class="arithmatex">\(K_{I}\)</span> and <span class="arithmatex">\(K_{D}\)</span>) must be <em>tuned</em> appropriately for any given system in order to achieve stability of control.</p>
<p>A PID Controller can actually take three different forms:</p>
<ol>
<li><strong>"P" Control</strong>: Only a <em>Proportional</em> gain (<span class="arithmatex">\(K_{P}\)</span>) is used, all other gains are set to zero.</li>
<li><strong>"PI" Control</strong>: <em>Proportional</em> and <em>Integral</em> gains (<span class="arithmatex">\(K_{P}\)</span> and <span class="arithmatex">\(K_{I}\)</span>) are applied, the Differential gain is set to zero. </li>
<li><strong>"PID" Control</strong>: The controller makes use of all three gain terms (<span class="arithmatex">\(K_{P}\)</span>, <span class="arithmatex">\(K_{I}\)</span> and <span class="arithmatex">\(K_{D}\)</span>)</li>
</ol>
<p>In order to allow our TurtleBot3 to follow a line, we actually only really need a <strong>"P" Controller</strong>, so our control equation becomes quite simple, reducing to:</p>
<div class="arithmatex">\[
u(t)=K_{P} e(t)
\]</div>
<p>The next task then is to adapt our <code>line_follower.py</code> node to implement this control algorithm and find a proportional gain that is appropriate for our system.</p>
<ol>
<li>
<p>Return to your <code>line_follower.py</code> file. Underneath the line that reads:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>Paste the following additional code:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">kp</span> <span class="o">=</span> <span class="mf">0.01</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">reference_input</span> <span class="o">=</span> <span class="p">{</span><span class="n">BLANK</span><span class="p">}</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="n">feedback_signal</span> <span class="o">=</span> <span class="n">cy</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="n">error</span> <span class="o">=</span> <span class="n">feedback_signal</span> <span class="o">-</span> <span class="n">reference_input</span> 
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="n">ang_vel</span> <span class="o">=</span> <span class="n">kp</span> <span class="o">*</span> <span class="n">error</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error = </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> pixels | Control Signal = </span><span class="si">{</span><span class="n">ang_vel</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Fill in the Blank!</p>
<p>What is the <strong>Reference Input</strong> to the control system (<code>reference_input</code>)? Refer to <a href="#pid_terms">this figure from earlier</a>. </p>
</div>
<p>Here we have implemented our "P" Controller. The <strong>Control Signal</strong> that is being calculated here is the angular velocity that will be applied to our robot (the code won't make the robot move just yet, but we'll get to that bit shortly!) The <strong>Controlled Output</strong> will therefore be the angular position (i.e. the <strong>yaw</strong>) of the robot.  </p>
</li>
<li>
<p>Run the code as it is, and consider the following:</p>
<ol>
<li>What proportional gain (<span class="arithmatex">\(K_{P}\)</span>) are we applying?</li>
<li>What is <a href="../../../about/robots/#max_vels">the maximum angular velocity that can be applied to our robot</a>? Is the angular velocity that has been calculated actually appropriate?</li>
<li>Is the angular velocity that has been calculated positive or negative? Will this make the robot turn in the right direction and move towards the line?  </li>
</ol>
</li>
<li>
<p>Let's address the third question (<strong>c</strong>) first...</p>
<p>A <strong>positive</strong> angular velocity should make the robot turn <strong>anti-clockwise</strong> (i.e. to the left), and a <strong>negative</strong> angular velocity should make the robot turn <strong>clockwise</strong> (to the right). The line should currently be to the left of the robot, which means a positive angular velocity would be required in order to make the robot turn towards it. If the value of the <strong>Control Signal</strong> that is being calculated by our proportional controller (as printed to the terminal) is negative, then this isn't correct, so we need to change the sign of our proportional gain (<span class="arithmatex">\(K_{P}\)</span>) in order to correct this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">kp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.01</span>
</code></pre></div>
</li>
<li>
<p>Next, let's address the second of the above questions (<strong>b</strong>)...</p>
<p>The maximum angular velocity that can be applied to our robot is &plusmn;1.82 rad/s. If our proportional controller is calculating a value for the <strong>Control Signal</strong> that is greater than 1.82, or less than -1.82 then this needs to be limited. In between the following two lines of code:</p>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="n">ang_vel</span> <span class="o">=</span> <span class="n">kp</span> <span class="o">*</span> <span class="n">error</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error = </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> pixels | Control Signal = </span><span class="si">{</span><span class="n">ang_vel</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Insert the following:
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">if</span> <span class="n">ang_vel</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.82</span><span class="p">:</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>    <span class="n">ang_vel</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.82</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="k">elif</span> <span class="n">ang_vel</span> <span class="o">&gt;</span> <span class="mf">1.82</span><span class="p">:</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>    <span class="n">ang_vel</span> <span class="o">=</span> <span class="mf">1.82</span>
</code></pre></div></p>
</li>
<li>
<p>Finally, we need to think about the actual proportional gain that is being applied. This is where we need to actually <em>tune</em> our system by finding a proportional gain value that controls our system appropriately.</p>
<p>Return to your <code>line_follower.py</code> file. Underneath the line that reads:</p>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error = </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> pixels | Control Signal = </span><span class="si">{</span><span class="n">ang_vel</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> rad/s&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Paste the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="bp">self</span><span class="o">.</span><span class="n">robot_controller</span><span class="o">.</span><span class="n">set_move_cmd</span><span class="p">(</span><span class="n">linear</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">angular</span> <span class="o">=</span> <span class="n">ang_vel</span><span class="p">)</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="bp">self</span><span class="o">.</span><span class="n">robot_controller</span><span class="o">.</span><span class="p">{</span><span class="n">BLANK</span><span class="p">}</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Fill in the Blank!</p>
<p>There is a method within the <code>Tb3Move()</code> class which allows us to publish a velocity command to the <code>/cmd_vel</code> topic. What is it? (Have a look at <a href="https://github.com/tom-howard/tuos_ros/blob/main/tuos_examples/src/tb3.py">the <code>tb3.py</code> source code</a>, or the <code>colour_search.py</code> file from Exercise 3 if you need a reminder).</p>
</div>
<p>Having filled in the <code>{BLANK}</code>, the code will now make the robot move with a constant linear velocity of 0.1 m/s at all times, while its angular velocity will be determined by our proportional controller, based on the controller error and the proportional gain parameter <code>kp</code>.</p>
<p>The figure below illustrates the effects different values of proportional gain can have on a system.</p>
<p><figure markdown>
  <img alt="" src="kp.png" width="600" />
  <figcaption>
    Courtesy of <a href="https://www.sheffield.ac.uk/dcs/people/academic/roger-k-moore">Prof. Roger Moore</a><br />
    Taken from COM2009 Lecture 6: PID Control
  </figcaption>
</figure></p>
<p>Run the code and see what happens. You should find that the robot behaves quite erratically, indicating that <code>kp</code> (at an absolute value of 0.01) is probably too large.</p>
</li>
<li>
<p>Try reducing <code>kp</code> by a factor of 100: <code class="highlight"><span class="n">kp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0001</span></code>. Before you run the code again, you can reset the Gazebo simulation by pressing <span class="keys"><kbd class="key-control">Ctrl</kbd><span>+</span><kbd class="key-shift">Shift</kbd><span>+</span><kbd class="key-r">R</kbd></span> so that the robot returns to the starting position.</p>
<p>You should find that the robot now gradually approaches the line, but it can take a while for it to do so.</p>
</li>
<li>
<p>Next, increase <code>kp</code> by a factor of 10: <code class="highlight"><span class="n">kp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.001</span></code>. Once again, reset the robot back to its starting position in Gazebo by using <span class="keys"><kbd class="key-control">Ctrl</kbd><span>+</span><kbd class="key-shift">Shift</kbd><span>+</span><kbd class="key-r">R</kbd></span> to reset the simulation.</p>
<p>The robot should now reach the line much quicker, and follow the line well once it reaches it.</p>
</li>
<li>
<p>Could <code>kp</code> be modified any more to improve the control further? Play around a bit more and see what happens. We'll but this to the test on a more challenging track in the next part of this exercise.</p>
</li>
</ol>
<h5 id="ex4c">Part C: Advanced Line Following<a class="headerlink" href="#ex4c" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p>Now, in <strong>TERMINAL 1</strong> run a new simulation:</p>
<hr />
<p><strong>TERMINAL 1:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>roslaunch<span class="w"> </span>tuos_simulations<span class="w"> </span>line_following.launch
</code></pre></div></p>
<p>Your robot should be launched into an environment with a more interesting line to follow:</p>
<p><figure markdown>
  <img alt="" src="line_following.png" width="800px" />
</figure></p>
</li>
<li>
<p>In <strong>TERMINAL 2</strong>, run your <code>line_follower.py</code> node and see how it performs. Does your proportional gain need to be adjusted further to optimise the performance?</p>
</li>
<li>
<p>Next, think about conditions where the line can't initially be seen...</p>
<p>As you know, the angular velocity is determined by considering the <code>cy</code> component of a colour blob representing the line. What happens in situations where the blob of colour isn't there though?  What influence would this have on the Control Signals that are calculated by the proportional controller? To consider this further, try launching the robot in the same arena but in a different location instead, and think about how you might approach this situation:</p>
<hr />
<p><strong>TERMINAL 1:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>roslaunch<span class="w"> </span>tuos_simulations<span class="w"> </span>line_following.launch<span class="w"> </span>x_pos:<span class="o">=</span><span class="m">3</span><span class="w"> </span>y_pos:<span class="o">=</span>-3<span class="w"> </span>yaw:<span class="o">=</span><span class="m">0</span>
</code></pre></div></p>
<hr />
</li>
<li>
<p>Finally, what happens when the robot reaches the finish line? How could you add additional functionality to ensure that the robot stops when it reaches this point? What features of the arena could you use to trigger this?</p>
</li>
</ol>
<h2 id="wrapping-up">Wrapping Up<a class="headerlink" href="#wrapping-up" title="Permanent link">&para;</a></h2>
<p>In this session you have learnt how to use data from a robot's camera to extract further information about its environment.  The camera allows our robot to "see" and the information that we obtain from this device can allow us to develop more advanced robotic behaviours such as searching for objects, follow things or - conversely - moving away or avoiding them.  You have learnt how to do some basic tasks with OpenCV, but this is a huge and very capable library of computer vision tools, and we encourage you to explore this further yourselves to enhance some of the basic principles that we have shown you today.</p>
<h3 id="backup">Saving your work<a class="headerlink" href="#backup" title="Permanent link">&para;</a></h3>
<p>Remember, the work you have done in the WSL-ROS environment during this session <strong>will not be preserved</strong> for future sessions or across different University machines automatically! To save the work you have done here today you should now run the following script in any idle WSL-ROS Terminal Instance:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>wsl_ros<span class="w"> </span>backup
</code></pre></div>
<p>This will export your home directory to your University U: Drive, allowing you to restore it again later.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>You can also use the <code>wsl_ros restore</code> command.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Camera topic names are slightly different on the real robots though, so look out for that!&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-01-08T13:00:25+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-01-08</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2022-11-20T10:56:24+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2022-11-20</span>
  </span>

    
    
    
  </aside>


  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../part5/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Part 5: ROS Actions">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Part 5: ROS Actions
              </div>
            </div>
          </a>
        
        
          
          <a href="../../la2/" class="md-footer__link md-footer__link--next" aria-label="Next: COM2009 Lab Assignment #2">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                COM2009 Lab Assignment #2
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 The University of Sheffield <br /> Content by <a href="https://www.sheffield.ac.uk/engineering/diamond-engineering/our-staff/tom-howard">Dr Tom Howard</a> (License: <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC</a>)<br /> <a href="#__consent">Change cookie settings</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to monitor the usage of these resources, and to understand how effective they are in supporting your learning. Cookies also help us to evaluate how much impact our teaching materials are making in the community. With your support, you are helping us to make our teaching resources better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.indexes", "toc.follow", "content.code.copy", "content.code.annotate", "content.action.edit", "content.action.view"], "search": "../../../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.7389ff0e.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="../../../assets/external/polyfill.io/v3/polyfill.min.7596a0b8.js"></script>
      
        <script src="../../../assets/external/cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>